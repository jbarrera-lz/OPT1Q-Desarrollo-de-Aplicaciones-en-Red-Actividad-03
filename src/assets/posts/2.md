## Introducción
---

Esta será la primera entrega de un demostrador donde intentaremos conectar una base de datos MongoDB con nuestra aplicación desarrollada en Angular.


## MongoDB
---

Se trata de un tipo de database documental ampliamente utilizada en la industria.

Sus principales características son:

* Los datos se almacenan en como documentos JSON, donde se pueden cambiar los campos entre documentos, así como la estructura de datos.

* Alta disponibilidad, escalado horizontal, siendo una base de datos distribuidas ```per se```.

* Gratuita, siendo su código fuente de libre acceso.

## MEAN stack
---

Lo que trataremos de hacer, es levantar vía ```DevContainers``` un __MEAN__ stack:
```MongoDB```, ```Express```, ```Angular``` y ```Node.js```. De esta manera, utilizaremos ```MongoDB``` para persistencia de datos, y gracias a ```Angular```, seremos capaces de realizar operaciones CRUD sobre una instancia de ```MongoDB```.

## Despliegue
---

Para nuestro setup de desarrollo, utilizaremos ```docker-compose``` y ```DevContainers```. Tal y como se observa en el código fuente disponible de la práctica, nuestro __MEAN__ stack tendrá la siguiente forma:

```yaml
##------------------------------------------------##
##              Anchors definitions               ##
##------------------------------------------------##
x-logging: &logging
    logging:
        driver: "json-file"
        options:
            max-size: 10m
            max-file: "3"
            compress: "true"

x-network: &unir-network
    networks:
        - unir

x-envfiles: &env-files
    env_file:
        - env

##------------------------------------------------##
##             Networks definitions               ##
##------------------------------------------------##
networks:
  unir:
    driver: bridge

##------------------------------------------------##
##             Services definitions               ##
##------------------------------------------------##
services:
  proxy:
    <<: [*logging, *unir-network, *env-files]
    image: docker.io/nginx:stable-alpine3.21-slim
    ports:
      - 80:80/tcp
      - 443:443/tcp
    container_name: proxy
    hostname: proxy
    restart: unless-stopped
    volumes:
      - ../nginx/unir.tutorial.conf:/etc/nginx/sites-enabled/unir.tutorial.conf:rw
      - ../nginx/unir.development.key:/etc/nginx/unir.development.key:rw
      - ../nginx/unir.development.crt:/etc/nginx/unir.development.crt:rw
      - ../nginx/nginx.conf:/etc/nginx/nginx.conf:rw

  web:
    <<: [*logging, *unir-network, *env-files]
    volumes:
      - ../:/workspace/:rw
    environment: {}
    build:
      context: ..
      dockerfile: ./Docker/Dockerfile
      target: development
      args:
        _base_image_: docker.io/node:25.2.1
    container_name: web
    hostname: web
    image: unir/gii-per-12824/desarrollo-aplicaciones-red/actividad02:development
    restart: unless-stopped
    stdin_open: true
    ports:
      - 4200/tcp
```

Yendo ahora a nuestra definición de ```DevContainer```, tenemos lo siguiente:

```json
{
    "name": "UNIR-Gii",
    "dockerComposeFile": [
        "../../Docker/docker-compose.yaml"
    ],
    "service": "web",
    "workspaceFolder": "/workspace",
    "remoteUser": "root",
    "customizations": {
        "vscode": {
            "extensions": [
                "redhat.vscode-yaml",
                "mechatroner.rainbow-csv",
                "jasonnutter.search-node-modules",
                "chris-noring.node-snippets",
                "aykutsarac.jsoncrack-vscode",
                "angular.ng-template"

            ]
        }
    },
    "features": {
        "ghcr.io/devcontainers-extra/features/apt-get-packages": {
            "packages": "vim"
        }
    },
    "postCreateCommand": "cd /workspace/.devcontainer/web; chmod +x -v post-create.sh; ./post-create.sh"
}
```

Una vez lanzado esta definición de ```DevContainer``` en nuestra instancia de ```VS Code```, tendremos disponible nuestra base de datos en la __URL__ ```mongodb://admin:pass@mongodb:27017```, que es lo que utilizaremos en siguientes entregas de este laboratorio para tener conectividad desde Angular hacia MongoDB.

Para lanzar nuestra aplicación de Angular, desde dentro de nuestro ```DevContainer```, ejecutamos en la consola el siguiente comando:

```shell
$ cd /workspace
$ ng serve --host 0.0.0.0 --port 4200 --open
```

La cual, estará disponible en nuestro navegador en la URL ```https://unir.development.es/```.

Continuará...
